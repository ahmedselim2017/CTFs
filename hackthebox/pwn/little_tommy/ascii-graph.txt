[0x0804865c]>  # int main (int argc, char **argv, char **envp);
                                                                                                                                                                                                                                               ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
                                                                                                                                                                                                                                               │  0x804865c                                                                                                       │
                                                                                                                                                                                                                                               │   ; DATA XREF from entry0 @ 0x8048507                                                                            │
                                                                                                                                                                                                                                               │ 761: int main (int argc, char **argv, char **envp);                                                              │
                                                                                                                                                                                                                                               │ ; var int32_t var_113h @ ebp-0x113                                                                               │
                                                                                                                                                                                                                                               │ ; var int32_t var_112h @ ebp-0x112                                                                               │
                                                                                                                                                                                                                                               │ ; var int32_t var_111h @ ebp-0x111                                                                               │
                                                                                                                                                                                                                                               │ ; var int32_t var_110h @ ebp-0x110                                                                               │
                                                                                                                                                                                                                                               │ ; var int32_t var_10ch @ ebp-0x10c                                                                               │
                                                                                                                                                                                                                                               │ ; var int32_t var_ch @ ebp-0xc                                                                                   │
                                                                                                                                                                                                                                               │ ; arg int32_t arg_4h @ esp+0x144                                                                                 │
                                                                                                                                                                                                                                               │ lea ecx, [arg_4h]                                                                                                │
                                                                                                                                                                                                                                               │ and esp, 0xfffffff0                                                                                              │
                                                                                                                                                                                                                                               │ push dword [ecx - 4]                                                                                             │
                                                                                                                                                                                                                                               │ push ebp                                                                                                         │
                                                                                                                                                                                                                                               │ mov ebp, esp                                                                                                     │
                                                                                                                                                                                                                                               │ push ebx                                                                                                         │
                                                                                                                                                                                                                                               │ push ecx                                                                                                         │
                                                                                                                                                                                                                                               │ sub esp, 0x110                                                                                                   │
                                                                                                                                                                                                                                               │ mov eax, dword gs:[0x14]                                                                                         │
                                                                                                                                                                                                                                               │ mov dword [var_ch], eax                                                                                          │
                                                                                                                                                                                                                                               │ xor eax, eax                                                                                                     │
                                                                                                                                                                                                                                               │ sub esp, 0xc                                                                                                     │
                                                                                                                                                                                                                                               │ ; 0x80489e0                                                                                                      │
                                                                                                                                                                                                                                               │ ; "\n#################### Welcome to Little Tommy's Handy yet Elegant and Advanced Program ####################" │
                                                                                                                                                                                                                                               │ push str.Welcome_to_Little_Tommy_s_Handy_yet_Elegant_and_Advanced_Program                                        │
                                                                                                                                                                                                                                               │ ; int puts(const char *s)                                                                                        │
                                                                                                                                                                                                                                               │ call sym.imp.puts;[oa]                                                                                           │
                                                                                                                                                                                                                                               │ add esp, 0x10                                                                                                    │
                                                                                                                                                                                                                                               │ mov byte [var_113h], 0                                                                                           │
                                                                                                                                                                                                                                               └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                                                                                                                                                                                                                                   v
                                                                                                                                                                                                                                                   │
                                                                                                                                                                                                                                           ┌───────┘
                                                                                                                                                                                                                                           │ ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
                                                                                                                                                                                                                            ┌────────────────│─┐                                                                                                                                                                                │
                                                                                                                                                                                                                            │              │ │ │                                                                                                                                                                                │
                                                                                                                                                                                                                            │        ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                  │
                                                                                                                                                                                                                            │        │  0x8048693                                                                                                                            │                                                  │
                                                                                                                                                                                                                            │        │ ; CODE XREF from main @ 0x8048950                                                                                                     │                                                  │
                                                                                                                                                                                                                            │        │ ;-- default:; from 0x80486e2                                                                                                          │                                                  │
                                                                                                                                                                                                                            │        │ sub esp, 0xc                                                                                                                          │                                                  │
                                                                                                                                                                                                                            │        │ ; 0x8048a4c                                                                                                                           │                                                  │
                                                                                                                                                                                                                            │        │ ; "\n1. Create account\n2. Display account\n3. Delete account\n4. Add memo\n5. Print flag\n\nPlease enter an operation number: "      │                                                  │
                                                                                                                                                                                                                            │        │ push str.1._Create_account__2._Display_account__3._Delete_account__4._Add_memo__5._Print_flag____Please_enter_an_operation_number:    │                                                  │
                                                                                                                                                                                                                            │        │ ; int printf(const char *format)                                                                                                      │                                                  │
                                                                                                                                                                                                                            │        │ call sym.imp.printf;[ob]                                                                                                              │                                                  │
                                                                                                                                                                                                                            │        │ add esp, 0x10                                                                                                                         │                                                  │
                                                                                                                                                                                                                            │        │ ; int getchar(void)                                                                                                                   │                                                  │
                                                                                                                                                                                                                            │        │ call sym.imp.getchar;[oc]                                                                                                             │                                                  │
                                                                                                                                                                                                                            │        │ mov byte [var_112h], al                                                                                                               │                                                  │
                                                                                                                                                                                                                            │        │ nop                                                                                                                                   │                                                  │
                                                                                                                                                                                                                            │        └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                  │
                                                                                                                                                                                                                            │            v                                                                                                                                                                                      │
                                                                                                                                                                                                                            │            │                                                                                                                                                                                      │
                                                                                                                                                                                                                            │            └──────────────────────────────────────────────────────┐                                                                                                                               │
                                                                                                                                                                                                                            │┌────────────────────────────────────────────────────────────────────┐                                                                                                                             │
                                                                                                                                                                                                                            ││                                                                  │ │                                                                                                                             │
                                                                                                                                                                                                                            ││                                                            ┌─────────────────────────────┐                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │  0x80486af                  │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │ ; int getchar(void)         │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │ call sym.imp.getchar;[oc]   │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │ mov byte [var_111h], al     │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │ cmp byte [var_111h], 0xa    │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            │ je 0x80486cc                │                                                                                                       │
                                                                                                                                                                                                                            ││                                                            └─────────────────────────────┘                                                                                                       │
                                                                                                                                                                                                                            ││                                                                    f t                                                                                                                           │
                                                                                                                                                                                                                            ││                                                                    │ │                                                                                                                           │
                                                                                                                                                                                                                            ││                                                                    │ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐  │
                                                                                                                                                                                                                            ││    ┌───────────────────────────────────────────────────────────────┘                                                                                                                          │  │
                                                                                                                                                                                                                            ││    │                                                                                                                                                                                          │  │
                                                                                                                                                                                                                            ││┌──────────────────────────────┐                                                                                                                                                               │  │
                                                                                                                                                                                                                            │││  0x80486c3                   │                                                                                                                                                               │  │
                                                                                                                                                                                                                            │││ cmp byte [var_111h], 0xff    │                                                                                                                                                               │  │
                                                                                                                                                                                                                            │││ jne 0x80486af                │                                                                                                                                                               │  │
                                                                                                                                                                                                                            ││└──────────────────────────────┘                                                                                                                                                               │  │
                                                                                                                                                                                                                            ││        f t                                                                                                                                                                                    │  │
                                                                                                                                                                                                                            ││        │ │                                                                                                                                                                                    │  │
                                                                                                                                                                                                                            │└──────────┘                                                                                                                                                                                    │  │
                                                                                                                                                                                                                            │       ┌─┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  │
                                                                                                                                                                                                                            │       │ │                                                                                                                                                                                         │
                                                                                                                                                                                                                            │ ┌───────────────────────────────┐                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │  0x80486cc                    │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ movsx eax, byte [var_112h]    │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ ; 49                          │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ sub eax, 0x31                 │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ ; 4                           │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ cmp eax, 4                    │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ │ ja case.default.0x80486e2     │                                                                                                                                                                 │
                                                                                                                                                                                                                            │ └───────────────────────────────┘                                                                                                                                                                 │
                                                                                                                                                                                                                            │         f t                                                                                                                                                                                       │
                                                                                                                                                                                                                            │         │ │                                                                                                                                                                                       │
                                                                                                                                                                                                                            └───────────┘                                                                                                                                                                                       │
                                                                                                                                                                                                                              ┌───────┘                                                                                                                                                                                         │
                                                                                                                                                                                                                              │                                                                                                                                                                                                 │
                                                                                                                                                                                                                          ┌───────────────────────────────────────┐                                                                                                                                                             │
                                                                                                                                                                                                                          │  0x80486db                            │                                                                                                                                                             │
                                                                                                                                                                                                                          │ mov eax, dword [eax*4 + 0x8048c0c]    │                                                                                                                                                             │
                                                                                                                                                                                                                          │ ; switch table (5 cases) at 0x8048c0c │                                                                                                                                                             │
                                                                                                                                                                                                                          │ ;-- switch                            │                                                                                                                                                             │
                                                                                                                                                                                                                          │ jmp eax                               │                                                                                                                                                             │
                                                                                                                                                                                                                          └───────────────────────────────────────┘                                                                                                                                                             │
                                                                                                                                                                                                                                        v v v v v                                                                                                                                                                               │
                                                                                                                                                                                                                                        │ │ │ │ │                                                                                                                                                                               │
                                                                                                                                                                                                                                        │ │ │ │ └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                     │
                 ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │ └───────────────────────────────────────────────────────────┐                                                                               │                                     │
                 │                                                                                                                   ┌────────────────────────────────────────────────────────────────────────────────────────────────────┘ └─────────────────┐                                           │                                                                               │                                     │
                 │                                                                                                                   │                                                                                                                        │                                           │                                                                               │                                     │
                 │                                                                                                                   │                                                                                                                        │                                           │                                                                               │                                     │
                 │                                                                                                                   │                                                                                                                        │                                           │                                                                               │                                     │
             ┌─────────────────────────────────────────────────────────┐                                                         ┌──────────────────────────────────────┐                                                                                 ┌──────────────────────────────────────┐    ┌───────────────────────────────────────────────────────────────────────────┐   ┌──────────────────────────────────────┐  │
             │  0x80486e4                                              │                                                         │  0x8048822                           │                                                                                 │  0x8048875                           │    │  0x80488b9                                                                │   │  0x8048915                           │  │
             │ ; CODE XREF from main @ 0x80486e2                       │                                                         │ ; CODE XREF from main @ 0x80486e2    │                                                                                 │ ; CODE XREF from main @ 0x80486e2    │    │ ; CODE XREF from main @ 0x80486e2                                         │   │ ; CODE XREF from main @ 0x80486e2    │  │
             │ ;-- case 0:; from 0x80486e2                             │                                                         │ ;-- case 1:; from 0x80486e2          │                                                                                 │ ;-- case 2:; from 0x80486e2          │    │ ;-- case 3:; from 0x80486e2                                               │   │ ;-- case 4:; from 0x80486e2          │  │
             │ sub esp, 0xc                                            │                                                         │ ; [0x804a048:4]=0                    │                                                                                 │ ; [0x804a048:4]=0                    │    │ sub esp, 0xc                                                              │   │ ; [0x804a048:4]=0                    │  │
             │ ; 'H'                                                   │                                                         │ mov eax, dword [obj.main_account]    │                                                                                 │ mov eax, dword [obj.main_account]    │    │ ; 0x8048b9f                                                               │   │ mov eax, dword [obj.main_account]    │  │
             │ ; 72                                                    │                                                         │ test eax, eax                        │                                                                                 │ test eax, eax                        │    │ ; "\nPlease enter memo:"                                                  │   │ test eax, eax                        │  │
             │ push 0x48                                               │                                                         │ jne 0x8048840                        │                                                                                 │ jne 0x8048893                        │    │ push str.Please_enter_memo:                                               │   │ je 0x804893f                         │  │
             │ ;  void *malloc(size_t size)                            │                                                         └──────────────────────────────────────┘                                                                                 └──────────────────────────────────────┘    │ ; int puts(const char *s)                                                 │   └──────────────────────────────────────┘  │
             │ call sym.imp.malloc;[od]                                │                                                                 f t                                                                                                                      f t                                 │ call sym.imp.puts;[oa]                                                    │           f t                               │
             │ add esp, 0x10                                           │                                                                 │ │                                                                                                                      │ │                                 │ add esp, 0x10                                                             │           │ │                               │
             │ ; [0x804a048:4]=0                                       │                                                                 │ │                                                                                                                      │ │                                 │ ; obj.__TMC_END                                                           │           │ │                               │
             │ mov dword [obj.main_account], eax                       │                                                                 │ │                                                                                                                      │ │                                 │ ; [0x804a040:4]=0                                                         │           │ │                               │
             │ sub esp, 0xc                                            │                                                                 │ │                                                                                                                      │ │                                 │ mov eax, dword [obj.stdin]                                                │           │ │                               │
             │ ; 0x8048ac2                                             │                                                                 │ │                                                                                                                      │ │                                 │ sub esp, 4                                                                │           │ │                               │
             │ ; "\nFirst name: "                                      │                                                                 │ │                                                                                                                      │ │                                 │ push eax                                                                  │           │ │                               │
             │ push str.First_name:                                    │                                                                 │ │                                                                                                                      │ │                                 │ ; 256                                                                     │           │ │                               │
             │ ; int printf(const char *format)                        │                                                                 │ │                                                                                                                      │ │                                 │ push 0x100                                                                │           │ │                               │
             │ call sym.imp.printf;[ob]                                │                                                                 │ │                                                                                                                      │ │                                 │ lea eax, [var_10ch]                                                       │           │ │                               │
             │ add esp, 0x10                                           │                                                                 │ │                                                                                                                      │ │                                 │ push eax                                                                  │           │ │                               │
             │ ; obj.__TMC_END                                         │                                                                 │ │                                                                                                                      │ │                                 │ ; char *fgets(char *s, int size, FILE *stream)                            │           │ │                               │
             │ ; [0x804a040:4]=0                                       │                                                                 │ │                                                                                                                      │ │                                 │ call sym.imp.fgets;[oe]                                                   │           │ │                               │
             │ mov eax, dword [obj.stdin]                              │                                                                 │ │                                                                                                                      │ │                                 │ add esp, 0x10                                                             │           │ │                               │
             │ sub esp, 4                                              │                                                                 │ │                                                                                                                      │ │                                 │ sub esp, 0xc                                                              │           │ │                               │
             │ push eax                                                │                                                                 │ │                                                                                                                      │ │                                 │ lea eax, [var_10ch]                                                       │           │ │                               │
             │ ; 256                                                   │                                                                 │ │                                                                                                                      │ │                                 │ push eax                                                                  │           │ │                               │
             │ push 0x100                                              │                                                                 │ │                                                                                                                      │ │                                 │ ; char *strdup(const char *src)                                           │           │ │                               │
             │ lea eax, [var_10ch]                                     │                                                                 │ │                                                                                                                      │ │                                 │ call sym.imp.strdup;[oi]                                                  │           │ │                               │
             │ push eax                                                │                                                                 │ │                                                                                                                      │ │                                 │ add esp, 0x10                                                             │           │ │                               │
             │ ; char *fgets(char *s, int size, FILE *stream)          │                                                                 │ │                                                                                                                      │ │                                 │ ; [0x804a04c:4]=0                                                         │           │ │                               │
             │ call sym.imp.fgets;[oe]                                 │                                                                 │ │                                                                                                                      │ │                                 │ mov dword [obj.memo], eax                                                 │           │ │                               │
             │ add esp, 0x10                                           │                                                                 │ │                                                                                                                      │ │                                 │ ; [0x804a04c:4]=0                                                         │           │ │                               │
             │ ; [0x804a048:4]=0                                       │                                                                 │ │                                                                                                                      │ │                                 │ mov eax, dword [obj.memo]                                                 │           │ │                               │
             │ mov eax, dword [obj.main_account]                       │                                                                 │ │                                                                                                                      │ │                                 │ sub esp, 8                                                                │           │ │                               │
             │ mov edx, eax                                            │                                                                 │ │                                                                                                                      │ │                                 │ push eax                                                                  │           │ │                               │
             │ sub esp, 4                                              │                                                                 │ │                                                                                                                      │ │                                 │ ; 0x8048bb4                                                               │           │ │                               │
             │ ; 30                                                    │                                                                 │ │                                                                                                                      │ │                                 │ ; "\nThank you, please keep this reference number number safe: %d.\n"     │           │ │                               │
             │ push 0x1e                                               │                                                                 │ │                                                                                                                      │ │                                 │ push str.Thank_you__please_keep_this_reference_number_number_safe:__d.    │           │ │                               │
             │ lea eax, [var_10ch]                                     │                                                                 │ │                                                                                                                      │ │                                 │ ; int printf(const char *format)                                          │           │ │                               │
             │ push eax                                                │                                                                 │ │                                                                                                                      │ │                                 │ call sym.imp.printf;[ob]                                                  │           │ │                               │
             │ push edx                                                │                                                                 │ │                                                                                                                      │ │                                 │ add esp, 0x10                                                             │           │ │                               │
             │ ; char *strncpy(char *dest, const char *src, size_t  n) │                                                                 │ │                                                                                                                      │ │                                 │ jmp 0x8048950                                                             │           │ │                               │
             │ call sym.imp.strncpy;[of]                               │                                                                 │ │                                                                                                                      │ │                                 └───────────────────────────────────────────────────────────────────────────┘           │ │                               │
             │ add esp, 0x10                                           │                                                                 │ │                                                                                                                      │ │                                     v                                                                                   │ │                               │
             │ ; [0x804a048:4]=0                                       │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ mov eax, dword [obj.main_account]                       │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ sub esp, 0xc                                            │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ push eax                                                │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ ; size_t strlen(const char *s)                          │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ call sym.imp.strlen;[og]                                │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ add esp, 0x10                                           │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ mov dword [var_110h], eax                               │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ cmp dword [var_110h], 0x1e                              │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             │ jg 0x8048773                                            │                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
             └─────────────────────────────────────────────────────────┘                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
                     f t                                                                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
                     │ │                                                                                                                 │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
                     │ └────────────────────────┐                                                                                        │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
    ┌────────────────┘                          │                                                                                        │ │                                                                                                                      │ │                                     │                                                                                   │ │                               │
    │                                           │                                                                                       ┌│─┘                                                                                                                      │ │                                     │                                                                                   │ │                               │
    │                                           │                                           ┌────────────────────────────────────────────┘                                                                                                                        │ │                                     │                                                                                   │ │                               │
    │                                           │                                           │                                           │                                                                                                                         │ └─────────────────────────────────────│                                                                                   │ │                               │
    │                                           │                                           │                                           │                                                                                                                     ┌───┘                                       └───────────────────────────────────────────┐                                       │ │                               │
    │                                           │                                           │                                           │                                                                                                                     │                                           │                                           │                                       │ └─────────────────┐             │
    │                                           │                                           │                                           │                                                                                                                     │                                           │                                           │                   ┌───────────────────┘                   │             │
    │                                           │                                           │                                           │                                                                                                                     │                                           │                                           │                   │                                       │             │
┌──────────────────────────────────────┐    ┌──────────────────────────────────────┐    ┌──────────────────────────────────────┐    ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐    ┌──────────────────────────────────────┐    ┌──────────────────────────────────────────┐    │               ┌──────────────────────────────────────┐    │             │
│  0x804875f                           │    │  0x8048773                           │    │  0x804882b                           │    │  0x8048840                                                                                                     │    │  0x804887e                           │    │  0x8048893                               │    │               │  0x804891e                           │    │             │
│ ; [0x804a048:4]=0                    │    │ ; [0x804a048:4]=0                    │    │ sub esp, 0xc                         │    │ ; [0x804a048:4]=0                                                                                              │    │ sub esp, 0xc                         │    │ ; [0x804a048:4]=0                        │    │               │ ; [0x804a048:4]=0                    │    │             │
│ mov eax, dword [obj.main_account]    │    │ mov eax, dword [obj.main_account]    │    │ ; 0x8048b01                          │    │ mov eax, dword [obj.main_account]                                                                              │    │ ; 0x8048b01                          │    │ mov eax, dword [obj.main_account]        │    │               │ mov eax, dword [obj.main_account]    │    │             │
│ mov edx, dword [var_110h]            │    │ mov byte [eax + 0x1f], 0             │    │ ; "\nSorry, no account found."       │    │ mov edx, dword [eax + 0x40]                                                                                    │    │ ; "\nSorry, no account found."       │    │ sub esp, 0xc                             │    │               │ mov eax, dword [eax + 0x40]          │    │             │
│ sub edx, 1                           │    └──────────────────────────────────────┘    │ push str.Sorry__no_account_found.    │    │ ; [0x804a048:4]=0                                                                                              │    │ push str.Sorry__no_account_found.    │    │ push eax                                 │    │               │ cmp eax, 0x6b637566                  │    │             │
│ mov byte [eax + edx], 0              │        v                                       │ ; int puts(const char *s)            │    │ mov eax, dword [obj.main_account]                                                                              │    │ ; int puts(const char *s)            │    │ ; void free(void *ptr)                   │    │               │ jne 0x804893f                        │    │             │
│ jmp 0x804877c                        │        │                                       │ call sym.imp.puts;[oa]               │    │ lea ecx, [eax + 0x20]                                                                                          │    │ call sym.imp.puts;[oa]               │    │ call sym.imp.free;[oh]                   │    │               └──────────────────────────────────────┘    │             │
└──────────────────────────────────────┘        │                                       │ add esp, 0x10                        │    │ ; [0x804a048:4]=0                                                                                              │    │ add esp, 0x10                        │    │ add esp, 0x10                            │    │                       f t                                 │             │
    v                                           │                                       │ jmp 0x8048950                        │    │ mov eax, dword [obj.main_account]                                                                              │    │ jmp 0x8048950                        │    │ sub esp, 0xc                             │    │                       │ │                                 │             │
    │                                           │                                       └──────────────────────────────────────┘    │ mov ebx, eax                                                                                                   │    └──────────────────────────────────────┘    │ ; 0x8048b81                              │    │                       │ │                                 │             │
    │                                           │                                           v                                       │ ; [0x804a048:4]=0                                                                                              │        v                                       │ ; "\nAccount deleted successfully"       │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ mov eax, dword [obj.main_account]                                                                              │        │                                       │ push str.Account_deleted_successfully    │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ sub esp, 0xc                                                                                                   │        │                                       │ ; int puts(const char *s)                │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ push edx                                                                                                       │        │                                       │ call sym.imp.puts;[oa]                   │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ push ecx                                                                                                       │        │                                       │ add esp, 0x10                            │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ push ebx                                                                                                       │        │                                       │ jmp 0x8048950                            │    │                       │ │                                 │             │
    │                                           │                                           │                                       │ push eax                                                                                                       │        │                                       └──────────────────────────────────────────┘    │                       │ │                                 │             │
    │                                           │                                           │                                       │ ; 0x8048b1c                                                                                                    │        │                                           v                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ ; "\n################ Account no. %d ################\nFirst name: %s\nLast name: %s\nAccount balance: %d\n\n" │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ push str.Account_no.__d___________________First_name:__s__Last_name:__s__Account_balance:__d                   │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ ; int printf(const char *format)                                                                               │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ call sym.imp.printf;[ob]                                                                                       │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ add esp, 0x20                                                                                                  │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       │ jmp 0x8048950                                                                                                  │        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                       └────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘        │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                           v                                                                                                                     │                                           │                                           │                       │ │                                 │             │
    │                                           │                                           │                                           │                                                                                                                     │                                           │                                           │                       │ │                                 │             │
    └──────────────┐                            │                                           │                                           │                                                                                                                     │                                           │                                           │                       │ │                                 │             │
                   │ ┌──────────────────────────┘                                           │                                           │                                                                                                                     │                                           │                                           │                       │ │                                 │             │
                   │ │                                                                      └───────────────────────────────────────────│─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────│───────────────────────────────────────────│───────────────────────────┐               │                       │ │                                 │             │
                   │ │                                                                                                                  └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────│───────────────────────────────────────────│───────────────────────────────┐           │                       │ │                                 │             │
                   │ │                                                                                                                                                                                                                                        └───────────────────────────────────────────│───────────────────────────────────┐       │                       │ │                                 │             │
                   │ │                                                                                                                                                                                                                                                                                    └───────────────────────────────────────┐   │                       │ │                                 │             │
                   │ │                                                                                                                                                                                                                                                                                                                │   │   │   │   │                       │ └───────────────────────┐         │             │
                   │ │                                                                                                                                                                                                                                                                                                                │   │   │   │   │       ┌───────────────┘                         │         │             │
                   │ │                                                                                                                                                                                                                                                                                                                │   │   │   │   │       │                                         │ ┌───────┘             │
                   │ │                                                                                                                                                                                                                                                                                                                │   │   │   │   │       │                                         │ │                     │
             ┌─────────────────────────────────────────────────────────┐                                                                                                                                                                                                                                                              │   │   │   │   │   ┌──────────────────────────────────┐    ┌───────────────────────────┐ │
             │  0x804877c                                              │                                                                                                                                                                                                                                                              │   │   │   │   │   │  0x804892d                       │    │  0x804893f                │ │
             │ ; CODE XREF from main @ 0x8048771                       │                                                                                                                                                                                                                                                              │   │   │   │   │   │ sub esp, 0xc                     │    │ sub esp, 0xc              │ │
             │ sub esp, 0xc                                            │                                                                                                                                                                                                                                                              │   │   │   │   │   │ ; 0x8048bf4                      │    │ ; 0x8048c02               │ │
             │ ; 0x8048ad0                                             │                                                                                                                                                                                                                                                              │   │   │   │   │   │ ; "/bin/cat flag"                │    │ ; "\nNope."               │ │
             │ ; "Last name: "                                         │                                                                                                                                                                                                                                                              │   │   │   │   │   │ push str.bin_cat_flag            │    │ push str.Nope.            │ │
             │ push str.Last_name:                                     │                                                                                                                                                                                                                                                              │   │   │   │   │   │ ; int system(const char *string) │    │ ; int puts(const char *s) │ │
             │ ; int printf(const char *format)                        │                                                                                                                                                                                                                                                              │   │   │   │   │   │ call sym.imp.system;[oj]         │    │ call sym.imp.puts;[oa]    │ │
             │ call sym.imp.printf;[ob]                                │                                                                                                                                                                                                                                                              │   │   │   │   │   │ add esp, 0x10                    │    │ add esp, 0x10             │ │
             │ add esp, 0x10                                           │                                                                                                                                                                                                                                                              │   │   │   │   │   │ jmp 0x804894f                    │    └───────────────────────────┘ │
             │ ; obj.__TMC_END                                         │                                                                                                                                                                                                                                                              │   │   │   │   │   └──────────────────────────────────┘        v                         │
             │ ; [0x804a040:4]=0                                       │                                                                                                                                                                                                                                                              │   │   │   │   │       v                                       │                         │
             │ mov eax, dword [obj.stdin]                              │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ sub esp, 4                                              │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push eax                                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; 256                                                   │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push 0x100                                              │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ lea eax, [var_10ch]                                     │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push eax                                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; char *fgets(char *s, int size, FILE *stream)          │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ call sym.imp.fgets;[oe]                                 │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ add esp, 0x10                                           │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; [0x804a048:4]=0                                       │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ mov eax, dword [obj.main_account]                       │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ lea edx, [eax + 0x20]                                   │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ sub esp, 4                                              │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; 30                                                    │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push 0x1e                                               │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ lea eax, [var_10ch]                                     │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push eax                                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push edx                                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; char *strncpy(char *dest, const char *src, size_t  n) │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ call sym.imp.strncpy;[of]                               │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ add esp, 0x10                                           │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; [0x804a048:4]=0                                       │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ mov eax, dword [obj.main_account]                       │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; 32                                                    │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ add eax, 0x20                                           │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ sub esp, 0xc                                            │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ push eax                                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ ; size_t strlen(const char *s)                          │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ call sym.imp.strlen;[og]                                │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ add esp, 0x10                                           │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ mov dword [var_110h], eax                               │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ cmp dword [var_110h], 0x1e                              │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             │ jg 0x80487fe                                            │                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
             └─────────────────────────────────────────────────────────┘                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
                     f t                                                                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
                     │ │                                                                                                                                                                                                                                                                                                              │   │   │   │   │       │                                       │                         │
                     │ └────────────────────────┐                                                                                                                                                                                                                                                                                     │   │   │   │   │       │                                       │                         │
    ┌────────────────┘                          │                                                                                                                                                                                                                                                                                     │   │   │   │   │       │                                       │                         │
    │                                           │                                                                                                                                                                                                                                                                                     │   │   │   │   │       └─────────────────┐                     │                         │
    │                                           │                                                                                                                                                                                                                                                                                     │   │   │   │   │                         │ ┌───────────────────┘                         │
    │                                           │                                                                                                                                                                                                                                                                                     │   │   │   │   │                         │ │                                             │
┌──────────────────────────────────────┐    ┌──────────────────────────────────────┐                                                                                                                                                                                                                                                  │   │   │   │   │                   ┌───────────────────────────────────┐                 │
│  0x80487e9                           │    │  0x80487fe                           │                                                                                                                                                                                                                                                  │   │   │   │   │                   │  0x804894f                        │                 │
│ ; [0x804a048:4]=0                    │    │ ; [0x804a048:4]=0                    │                                                                                                                                                                                                                                                  │   │   │   │   │                   │ ; CODE XREF from main @ 0x804893d │                 │
│ mov eax, dword [obj.main_account]    │    │ mov eax, dword [obj.main_account]    │                                                                                                                                                                                                                                                  │   │   │   │   │                   │ nop                               │                 │
│ mov edx, dword [var_110h]            │    │ mov byte [eax + 0x3f], 0             │                                                                                                                                                                                                                                                  │   │   │   │   │                   └───────────────────────────────────┘                 │
│ sub edx, 1                           │    └──────────────────────────────────────┘                                                                                                                                                                                                                                                  │   │   │   │   │                       v                                                 │
│ mov byte [eax + edx + 0x20], 0       │        v                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
│ jmp 0x8048807                        │        │                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
└──────────────────────────────────────┘        │                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
    v                                           │                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
    │                                           │                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
    └──────────────────┐                        │                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
                       │ ┌──────────────────────┘                                                                                                                                                                                                                                                                                     │   │   │   │   │                       │                                                 │
                       │ │                                                                                                                                                                                                                                                                                                            │   │   │   │   │                       └─────────────┐                                   │
                       │ │                                                                                                                                                                                                                                                                                                            │   │   │   │   │                                     │                                   │
                 ┌────────────────────────────────────────────────┐                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │  0x8048807                                     │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ ; CODE XREF from main @ 0x80487fc              │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ ; [0x804a048:4]=0                              │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ mov eax, dword [obj.main_account]              │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ sub esp, 8                                     │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ push eax                                       │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ ; 0x8048adc                                    │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ ; "\nThank you, your account number %d.\n"     │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ push str.Thank_you__your_account_number__d.    │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ ; int printf(const char *format)               │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ call sym.imp.printf;[ob]                       │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ add esp, 0x10                                  │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 │ jmp 0x8048950                                  │                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                 └────────────────────────────────────────────────┘                                                                                                                                                                                                                                                                   │   │   │   │   │                                     │                                   │
                     v                                                                                                                                                                                                                                                                                                                │   │   │   │   │                                     │                                   │
                     │                                                                                                                                                                                                                                                                                                                │   │   │   │   │                                     │                                   │
                     └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                             │   │   │   │   │                                     │                                   │
                                                                                                                                                                                                                                                        │ ┌───────────────────────────────────────────────────────────────────────────│───│───│───│───│─────────────────────────────────────┘                                   │
                                                                                                                                                                                                                                                        │ │ ┌─────────────────────────────────────────────────────────────────────────│───│───│───│───┘                                                                         │
                                                                                                                                                                                                                                                        │ │ │ ┌───────────────────────────────────────────────────────────────────────│───│───┘   │                                                                             │
                                                                                                                                                                                                                                                        │ │ │ │ ┌─────────────────────────────────────────────────────────────────────│───│───────┘                                                                             │
                                                                                                                                                                                                                                                        │ │ │ │ │ ┌───────────────────────────────────────────────────────────────────┘   │                                                                                     │
                                                                                                                                                                                                                                                        │ │ │ │ │ │ ┌─────────────────────────────────────────────────────────────────────┘                                                                                     │
                                                                                                                                                                                                                                                        │ │ │ │ │ │ │                                                                                                                                                           │
                                                                                                                                                                                                                                                  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                           │
                                                                                                                                                                                                                                                  │  0x8048950                                                                                                      │                                                           │
                                                                                                                                                                                                                                                  │ ; XREFS: CODE 0x0804881d  CODE 0x0804883b  CODE 0x08048870  CODE 0x0804888e  CODE 0x080488b4  CODE 0x08048913   │                                                           │
                                                                                                                                                                                                                                                  │ jmp case.default.0x80486e2                                                                                      │                                                           │
                                                                                                                                                                                                                                                  └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                           │
                                                                                                                                                                                                                                                      v                                                                                                                                                                         │
                                                                                                                                                                                                                                                      │                                                                                                                                                                         │
                                                                                                                                                                                                                                                      └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
